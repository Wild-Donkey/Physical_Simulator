# 计算机模拟电磁学大题

## 磁场

电荷在磁场中运动, 会受到垂直于运动方向和磁场方向的洛伦兹力.

如果以和磁场垂直的初速度, 只受匀强磁场力影响, 那么它会在垂直于磁场方向的平面上做匀速圆周运动. 因为洛伦兹力提供向心力, 因此半径 $r$ 和周期 $T$ 满足这样的式子.

$$
\begin{aligned}
\frac {mv^2}r &= qvB\\
r &= \dfrac {mv}{qB}\\
T &= \dfrac {2\pi r}v = \dfrac {2\pi m}{qB}
\end{aligned}
$$

如果在平行于地面的方向施加匀强磁场, 并且有一个不忽略重力的带点小球从静止释放, 那么这个小球会先只受到重力, 随着速度增加受到逐渐增加的洛伦兹力, 速度偏转直到水平, 然后斜向上运动直到到达原来的位置时静止, 做周期性运动. 分解速度我们发现这是一个匀速直线运动和线速度和它相同的匀速圆周运动的和运动.

根据动能全部由重力做功得到, 可以得到每个运动周期的位移 $x$, 和质量 $m$, 电荷量 $q$ 之间的关系. 这里用 $v$, $r$ 表示分运动中匀速圆周运动的速度和半径.

$$
\begin{aligned}
T &= \dfrac {2\pi m}{qB}\\ 
\dfrac {m(2v)^2}2 &= 2rmg\\
r &= \dfrac {mv}{qB}\\
v &= \dfrac g{qB}\\
x &= Tv = \dfrac{2\pi mg}{B^2q^2}\\ 
\end{aligned}
$$

## 电场

电荷在电场中, 会受到平行于电场方向的库仑力.

这时如果在垂直于匀强电场和电荷运动速度的方向, 施加一个方向大小合适的磁场力, 那么就会使电荷所受电场力和磁场力平衡.

$$
\begin{aligned}
qE &= qvB\\
v &= \dfrac EB
\end{aligned}
$$

这个装置就是一个针对比荷相同, 重力忽略的粒子的速度选择器 (其实重力不可忽略时只需调整电场强度抵消重力即可), 速度过大和过小都不能做匀速直线运动.

但是, 根据前面的运动分解的方法, 可以发现速度不符合要求的粒子做的运动仍然是一个匀速直线运动和匀速圆周运动的和运动, 所以对于特定速度的粒子, 它们周期性运动到初始高度时, 若恰好到达有边界, 则也可以通过速度选择器.

我们设匀速圆周运动的速度是 $v_0$, 半径为 $r$, 匀速直线运动的速度为 $v_1$.

$$
\begin{aligned}
T &= \dfrac {2\pi m}{qB}\\ 
\dfrac {m(v_1 + v_0)^2}2 - \dfrac {m(v_1 - v_0)^2}2 &= 2rE\\
mv_1v_0 &= rE\\
r &= \dfrac {mv_0}{qB}\\
v_1 &= \dfrac E{qB}\\
x &= Tv_1 = \dfrac{2\pi mE}{B^2q^2}\\ 
\end{aligned}
$$

因此我们发现无论是周期位移还是平均速度, 都和初速度无关, 因此只要我们的选择器长度不选择 $\dfrac{2\pi mE}{B^2q^2}$ 的整数倍, 都可以准确选出所需速度的粒子.

如果在两处匀强磁场中间施加方向周期性变化的匀强电场, 可以获得加速粒子的效果, 这就是回旋加速器的原理.

由于加速次数不受限制, 因此最大速度只受回旋半径限制, 而半径和电场强度无关, 和磁场和比荷有关, 因此无论电场强度如何, 最大速度都之和磁场和比荷有关.

我们可以仅在一侧设计电场, 使得电荷每绕一圈只被加速一次, 这样就可以把变化的电场优化为恒定电场.

## 实现

定义模拟步长, 将每一个模拟帧单独计算加速度对速度的影响和速度对位移的影响, 然后把轨迹经历的点存储起来, 每个渲染帧调用未过期的轨迹点, 将其渲染成像素矩阵, 然后复制 BMP 的文件头生成图像, 最后将图像用 ffmpeg 合成为视频.

代码可以转至简介区的 github 链接取得.